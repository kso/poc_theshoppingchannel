

<div class="row">
    <div ng-if="search.query" class="section-title">Search Results for: {{search.query}}</div>
    <div ng-if="!search.query" class="section-title">Browse All Products</div>
</div>
<div class="row">
  <div class="navigation-well well col-sm-2">
    <ul class="list-group">
      <div ng-repeat="selnav in search.selectedNavigation">
        <li class="list-group-item refinement" ng-repeat="selref in selnav.refinements"
             ng-click="search.unrefine(selnav.name, selref)">
          <span ng-if="!selnav.range">{{selnav.displayName}}: {{selref.value}}</span>
          <span ng-if="selnav.range">{{selnav.displayName}}: {{selref.low}}-{{selref.high}}</span>
          <p class="glyphicon glyphicon-remove"></p>
        </li>
      </div>
    </ul>  
    <div class="navigation" ng-repeat="nav in search.navigation">
      <div ng-click="nav.collapsed = !nav.collapsed"> 
        <span >{{nav.raw.displayName}}</span>
        <p class="nav-collapse glyphicon" ng-class="nav.collapsed ? 'glyphicon-menu-right' : 'glyphicon-menu-down'"></p>
      </div>

      <!-- For range refinements there are a few ways we can interact with them
       1. Range slider
       2. Buckets (single or multi select)
       3. Specialized (e.g. Ratings / Customer Review Selector)
       -->

      <!-- Reviews selector  -->
      <ul ng-if="nav.rating" class="list-group" uib-collapse="nav.collapsed">
        <li class="list-group-item refinement" 
            ng-repeat="refinement in nav.raw.refinements"
            ng-click="(search.refinements | filter:{navigationName : nav.raw.name}).length > 0  ? 
              search.unrefine(nav.raw.name, refinement) : 
              search.refine(nav.raw.name, refinement, 'Range')">
          <uib-rating
            ng-model="refinement.high"
            readonly='true'></uib-rating> 
          <span class="badge">{{refinement.count}}</span>
        </li>
      </ul>

      <rzslider ng-show="!nav.collapsed" ng-if="nav.range"
        rz-slider-model="nav.slider.min"
        rz-slider-high="nav.slider.max"
        rz-slider-options="nav.slider.options"></rzslider>

      <ul ng-if="!nav.range && !nav.rating && !nav.color" class="list-group" uib-collapse="nav.collapsed">
        <li class="list-group-item refinement" 
            ng-repeat="refinement in nav.raw.refinements | limitTo:5 "
            ng-click="(search.refinements | filter:{navigationName : nav.raw.name, value: refinement.value}).length > 0  ? 
              search.unrefine(nav.raw.name, refinement) : 
              search.refine(nav.raw.name, refinement, 'Value')">
          <span ng-if="nav.raw.or" 
            ng-class="(search.refinements | filter:{navigationName : nav.raw.name, value: refinement.value}).length > 0  ? 
              'glyphicon-check' : 
              'glyphicon-unchecked'" 
            class="state-icon glyphicon"></span>
          <span class="badge">{{refinement.count}}</span>
          <span>{{refinement.value}}</span>
        </li>
      </ul>

      <div class="color-refinement-container"ng-if="nav.color" uib-collapse="nav.collapsed">
        <div class="color-refinement" 
            ng-repeat="refinement in nav.raw.refinements | limitTo:10 "
            ng-click="(search.refinements | filter:{navigationName : nav.raw.name, value: refinement.value}).length > 0  ? 
              search.unrefine(nav.raw.name, refinement) : 
              search.refine(nav.raw.name, refinement, 'Value')"
            ng-style="{'background-color' : refinement.value}">
          <span ng-if="nav.raw.or" 
            ng-class="(search.refinements | filter:{navigationName : nav.raw.name, value: refinement.value}).length > 0  ? 
              'glyphicon-remove' : 
              ''" 
            class="state-icon glyphicon"></span>
        </div>
      </div>

    </div>
  </div>

  <div class="results-well well col-sm-10 col-xs-12">
    <div class="row">

      <div class="col-xs-7">
        <div class="results-title">
          <h2><small>{{search.resultSummary}}</small></h1>
        </div>
        
      </div>

      <div class="col-xs-5">
        <uib-pager   class = "pager"
                     align = "false" 
                     total-items="search.totalRecordCount" 
                     ng-model="currentPage"
                     ng-change="search.search()" 
                     items-per-page="search.pageSize">
        </uib-pager>

        <select class="form-control sort"
                ng-model="sort" 
                ng-init="sort=sortFields[0]" 
                ng-options="sortField as sortField.display for sortField in sortFields"
                ng-change="search.search()">
        </select>

      </div>
    </div>
    <div class="row">

      <div class="product-container col-sm-3 col-xs-6" ng-repeat="result in search.resultList">
        <div class="product-thumb-container" style="position:relative">
          <a href="/product/{{result.allMeta.ID}}" class="product-thumb">
            <img class="thumbnail img-responsive" ng-src="{{result.allMeta.ClargeImage}}">
            <h5>{{result.allMeta.Ctitle}}</h5>
          </a>
          <div class="hover-btn" ng-click="search.inspect(result.allMeta.ID)">
            <i class="glyphicon glyphicon-eye-open"></i>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>









